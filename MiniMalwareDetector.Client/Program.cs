namespace MiniMalwareDetector.Client
{
    internal static class Program
    {
        static void Main(string[] args)
        {
            if (args.Length < 2)
            {
                Console.WriteLine("Не переданы аргументы");
                return;
            }

            var httpService = new HttpService();

            if (args[0].ToLower() != "scan" && args[0].ToLower() != "status")
            {
                Console.WriteLine("Не правильная команда");
                return;
            }
            else if (args[0].ToLower() == "scan")
            {
                 var pathDirectory = args[1];
                 if (!Directory.Exists($@"{pathDirectory}"))
                 {
                     Console.WriteLine("Данной директории не существует");
                     return;
                 }

                 var scanId = httpService.SendFilesForScan(pathDirectory).Result;
                 Console.WriteLine($"Сканирование запущено с Id: {scanId}");
            }
            else if (args[0].ToLower() == "status")
            {
                var scanId = args[1];
                Console.WriteLine(httpService.GetStatusScan(scanId).Result);
            }
        }
    }
}