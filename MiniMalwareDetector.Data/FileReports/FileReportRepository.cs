using MiniMalwareDetector.Core.FileReports;
using MiniMalwareDetector.Core.FileReports.Repository;

namespace MiniMalwareDetector.Data.FileReports;

public class FileReportRepository : IFileReportRepository
{
    private static List<FileReportModel> _fileReportStorage = new List<FileReportModel>();
    public Guid Create(FileReport fileReport)
    {
        var entity = new FileReportModel()
        {
            Id = Guid.NewGuid(),
            FileName = fileReport.FileName,
            RuleId = fileReport.RuleId,
            ReportType = fileReport.ReportType,
            ScanReportId = fileReport.ScanReportId
        };
        
        _fileReportStorage.Add(entity);
        return entity.Id;
    }

    public List<FileReport> GetFileReportsByScanReportId(Guid id)
    {
       return new List<FileReport>(_fileReportStorage
            .Where(x => x.ScanReportId == id)
            .Select(x => new FileReport()
            {
                Id = x.Id,
                FileName = x.FileName,
                RuleId = x.RuleId,
                ReportType = x.ReportType,
                ScanReportId = x.ScanReportId
            }));
    }
}