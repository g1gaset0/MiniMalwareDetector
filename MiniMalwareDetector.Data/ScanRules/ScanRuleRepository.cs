using MiniMalwareDetector.Core.ScanRules;
using MiniMalwareDetector.Core.ScanRules.Repository;

namespace MiniMalwareDetector.Data.ScanRules;

/// <summary>
/// Класс реализующий репозиторий для правил сканирования
/// </summary>
public class ScanRuleRepository : IScanRuleRepository
{
    /// <summary>
    /// Коллекция правил
    /// </summary>
    private static ScanRuleModel[] _scanRuleStorage = {
        new ScanRuleModel()
        {
            Id = Guid.NewGuid(),
            Name = "JS",
            Malware = "<script>evil_script()</script>",
            Extension = ".js"
        },
        new ScanRuleModel()
        {
            Id = Guid.NewGuid(),
            Name = "rm -rf",
            Malware = @"rm -rf %userprofile%\Document"
        },
        new ScanRuleModel()
        {
            Id = Guid.NewGuid(),
            Name = "Rundll32",
            Malware = "Rundll32 sus.dll SusEntry"
        }
    };
    
    /// <summary>
    /// Получить все правила из коллекции
    /// </summary>
    /// <returns>Список правил</returns>
    public List<ScanRule> GetAll()
    {
        return new List<ScanRule>(_scanRuleStorage.Select(x => new ScanRule()
        {
            Id = x.Id,
            Name = x.Name,
            Malware = x.Malware,
            Extension = x.Extension
        }));
    }
}