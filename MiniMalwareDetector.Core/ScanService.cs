using MiniMalwareDetector.Core.ScanReports;
using MiniMalwareDetector.Core.ScanReports.Repository;
using MiniMalwareDetector.Core.ScanRules.Repository;

namespace MiniMalwareDetector.Core;

public class ScanService : IScanService
{
    private readonly IScanRuleRepository _scanRuleRepository;
    private readonly IScanReportRepository _scanReportRepository;

    public ScanService(IScanRuleRepository scanRuleRepository, IScanReportRepository scanReportRepository)
    {
        _scanRuleRepository = scanRuleRepository;
        _scanReportRepository = scanReportRepository;
    }

    public async Task Scan(string id)
    {
        var scanRuleList = _scanRuleRepository.GetAll();
        var scanReport = new ScanReport()
        {
            ScanRulesId = scanRuleList.Select(x => x.Id).ToList()
        };

        /// Доделать запуск сканирования
    }
}