using Microsoft.AspNetCore.Http;
using Microsoft.Extensions.Configuration;

namespace MiniMalwareDetector.Core;

public class FileService : IFileService
{
    public async Task SaveFiles(List<IFormFile> formFiles, string id)
    {
        var currentDirectory = Path.Combine(Path.Combine(Directory.GetCurrentDirectory(), "Scanning"), id);
        Directory.CreateDirectory(currentDirectory);

        foreach (var file in formFiles.Where(file => file.Length > 0))
        {
            using (var stream = File.Create(Path.Combine(currentDirectory, file.FileName)))
            {
                await file.CopyToAsync(stream);
            }
        }
    }
}